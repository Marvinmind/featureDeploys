(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{jA6l:function(t,e,n){"use strict";n.r(e),n.d(e,"SubscriptionModule",(function(){return Te}));var i=n("ofXK"),c=n("tyNb"),r=n("mrSG"),a=n("txUS"),o=n("2Vo4"),s=n("XNiG"),d=n("itXk"),l=n("pLZG"),p=n("5+tZ"),g=n("UXun"),b=n("1G5W"),u=n("eIep"),h=n("lJxs"),f=n("vkgz"),m=n("ZGuP"),v=n("LCh+"),P=n("ZFx6"),x=n("SnNG"),O=n("gEt1"),C=n("l7P3");const T=Object(C.n)("[Products] Load Products"),y=Object(C.n)("[Products] Set Products",Object(C.s)()),U=Object(C.p)([],Object(C.r)(y,(t,e)=>[...e.products]));function _(t,e){return U(t,e)}const I=Object(C.o)("products"),M=Object(C.q)(I,t=>t.filter(t=>t.type===a.ProductType.SUBSCRIPTION)),w=Object(C.q)(I,t=>t.filter(t=>t.type===a.ProductType.STORAGE_UPGRADE)),S=Object(C.q)(I,t=>t.filter(t=>t.type===a.ProductType.SUBSCRIPTION||t.type===a.ProductType.TRIAL));var k=n("fXoL"),B=n("LcAk"),N=n("TY1r"),j=n("R1ws"),R=n("j14s");const D=["*",[["mat-card-footer"]]],E=["*","mat-card-footer"];let z=(()=>{class t{constructor(t){this._animationMode=t}}return t.\u0275fac=function(e){return new(e||t)(k.Ob(j.a,8))},t.\u0275cmp=k.Ib({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-card"],hostVars:2,hostBindings:function(t,e){2&t&&k.Gb("_mat-animation-noopable","NoopAnimations"===e._animationMode)},exportAs:["matCard"],ngContentSelectors:E,decls:2,vars:0,template:function(t,e){1&t&&(k.qc(D),k.pc(0),k.pc(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(.4,0,.2,1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}@media (-ms-high-contrast:active){.mat-card{outline:solid 1px}}.mat-card-actions,.mat-card-content,.mat-card-subtitle{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media (max-width:599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card-content>:first-child,.mat-card>:first-child{margin-top:0}.mat-card-content>:last-child:not(.mat-card-footer),.mat-card>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-subtitle:not(:first-child),.mat-card-title:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),t})(),G=(()=>{class t{}return t.\u0275mod=k.Mb({type:t}),t.\u0275inj=k.Lb({factory:function(e){return new(e||t)},imports:[[R.k],R.k]}),t})();var $=n("sYmb");let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=k.Ib({type:t,selectors:[["app-storage-option-card"]],inputs:{product:"product"},decls:18,vars:14,consts:[[1,"mt-3","mat-elevation-z0"],[1,"w-100","d-flex","justify-content-center","icon-container"],[3,"src"],[1,"d-flex","flex-column","align-items-center","w-100","montserrat-text-light"],[1,"font-weight-bold","text-size-3","mt-3"],[1,"font-weight-bold","text-size-3","primary-color-text","mt-2"],[1,"grey","font-weight-bold","text-size-2","mt-4"],[1,"grey","text-size-0","mt-1"],[1,"text-size-1","font-weight-bold","primary-color-text","mt-3"]],template:function(t,e){1&t&&(k.Ub(0,"mat-card",0),k.Ub(1,"div",1),k.Pb(2,"img",2),k.Tb(),k.Ub(3,"div",3),k.Ub(4,"span",4),k.Pc(5),k.Tb(),k.Ub(6,"span",5),k.Pc(7),k.lc(8,"translate"),k.Tb(),k.Ub(9,"span",6),k.Pc(10),k.Tb(),k.Ub(11,"span",7),k.Pc(12),k.lc(13,"translate"),k.Tb(),k.Ub(14,"span",8),k.Pc(15),k.lc(16,"uppercase"),k.lc(17,"translate"),k.Tb(),k.Tb(),k.Tb()),2&t&&(k.Bb(2),k.rc("src","assets/images/icons/storage/"+e.product.shortName+"-storage.svg",k.Gc),k.Bb(3),k.Qc(e.product.shortName),k.Bb(2),k.Qc(k.mc(8,6,"storageUpgrade.size."+e.product.shortName)),k.Bb(3),k.Rc("",e.product.plans[0].costPerUser.EUR,"\u20ac"),k.Bb(2),k.Qc(k.mc(13,8,"storageUpgrade.perYear")),k.Bb(3),k.Qc(k.mc(16,10,k.mc(17,12,"storageUpgrade.comingSoon"))))},directives:[z],pipes:[$.d,i.z],styles:["mat-card[_ngcontent-%COMP%]{height:400px;border-radius:24px}mat-card[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{height:100px}mat-card[_ngcontent-%COMP%]   .text-size-3[_ngcontent-%COMP%]{font-size:32px}mat-card[_ngcontent-%COMP%]   .text-size-2[_ngcontent-%COMP%]{font-size:24px}mat-card[_ngcontent-%COMP%]   .text-size-1[_ngcontent-%COMP%]{font-size:16px}mat-card[_ngcontent-%COMP%]   .text-size-0[_ngcontent-%COMP%]{font-size:14px}mat-card[_ngcontent-%COMP%]   .primary-color-text[_ngcontent-%COMP%]{color:var(--app-primary)}mat-card[_ngcontent-%COMP%]   .grey[_ngcontent-%COMP%]{color:#2c211d}"]}),t})();function L(t,e){if(1&t&&(k.Ub(0,"div",8),k.Pb(1,"app-storage-option-card",9),k.Tb()),2&t){const t=e.$implicit;k.Bb(1),k.rc("product",t)}}let Q=(()=>{class t{constructor(t,e){this.store=t,this.dialogRef=e,this.initProducts()}close(){this.dialogRef.close()}initProducts(){this.storageUpgradeProducts$=this.store.select(w).pipe(Object(h.a)(t=>{const e=[...t];return e.sort((t,e)=>t.grade-e.grade),e}))}}return t.\u0275fac=function(e){return new(e||t)(k.Ob(C.h),k.Ob(B.g))},t.\u0275cmp=k.Ib({type:t,selectors:[["app-storage-options-dialog"]],decls:15,vars:9,consts:[[1,"pointer","d-flex","justify-content-start","align-items-center",3,"click"],[1,"montserrat-text","ml-1","hint"],[1,"container","card-container"],[1,"row"],["class","col-4",4,"ngFor","ngForOf"],[1,"row","mt-3"],[1,"w-100","d-flex","justify-content-center"],[1,"montserrat-text-light"],[1,"col-4"],[3,"product"]],template:function(t,e){1&t&&(k.Ub(0,"div",0),k.gc("click",(function(){return e.close()})),k.Ub(1,"mat-icon"),k.Pc(2,"close"),k.Tb(),k.Ub(3,"span",1),k.Pc(4),k.lc(5,"translate"),k.Tb(),k.Tb(),k.Ub(6,"div",2),k.Ub(7,"div",3),k.Nc(8,L,2,1,"div",4),k.lc(9,"async"),k.Tb(),k.Ub(10,"div",5),k.Ub(11,"div",6),k.Ub(12,"span",7),k.Pc(13),k.lc(14,"translate"),k.Tb(),k.Tb(),k.Tb(),k.Tb()),2&t&&(k.Bb(4),k.Qc(k.mc(5,3,"storageUpgrade.cancel")),k.Bb(4),k.rc("ngForOf",k.mc(9,5,e.storageUpgradeProducts$)),k.Bb(5),k.Qc(k.mc(14,7,"storageUpgrade.hint")))},directives:[N.a,i.o,A],pipes:[$.d,i.b],styles:[".hint[_ngcontent-%COMP%]{line-height:16px;font-size:16px}.card-container[_ngcontent-%COMP%]{width:1000px}"]}),t})();var F=n("wd/R"),V=n.n(F),W=n("SYtq"),q=n("gVAj"),H=n("IUeq"),Y=n("1KTt"),Z=n("ZZO6"),K=n("egyA"),X=n("p470"),J=n("HE6z"),tt=n("Xlwt"),et=n("bLhV"),nt=n("BcPx"),it=n("HELM"),ct=n("xrj2"),rt=n("mLDw"),at=n("6wtU"),ot=n("31NI"),st=n("3Pt+"),dt=n("Quzu"),lt=n("G/Ji");function pt(t,e){1&t&&(k.Ub(0,"div"),k.Pb(1,"mat-spinner",7),k.Tb()),2&t&&(k.Bb(1),k.rc("diameter",26))}let gt=(()=>{class t{constructor(t,e,n,i){this.translateService=t,this.productChangeService=e,this.subscriptionChangeTranslationService=n,this.trackingDispatcherService=i,this._selectedPaymentInterval=a.PlanPaymentInterval.MONTHLY,this.locked=!1,this.costText="",this.changeDateText="",this.PlanPaymentInterval=a.PlanPaymentInterval}set currentlySubscribedInterval(t){this.selectedPaymentInterval=t}get selectedPaymentInterval(){return this._selectedPaymentInterval}set selectedPaymentInterval(t){this.locked||(this._selectedPaymentInterval=t,this.productChangeService.updatePaymentInterval(this.selectedPaymentInterval))}set paymentIntervalChange(t){t&&(t.status!==v.a.PROCESSING?(t.status===v.a.CONFIRMED&&(this.locked=!1),this.costText=this.getChangeText(t),this.changeDateText=this.getChangeDateText(t),this._paymentIntervalChange=t):this.locked=!0)}getChangeText(t){const e=t.changeDirection===rt.a.DOWNGRADE?t.subscription.renewalDate:V()().unix(),n=Object(P.s)(t.billingDetails.billing.address.country,t.to.plan,e),i=Object(P.f)(t,n);return this.subscriptionChangeTranslationService.getCostChangeText(t,i,n)}getChangeDateText(t){return this.subscriptionChangeTranslationService.getDateChangeText(t)}onConfirm(){this.trackingDispatcherService.emitTrackingEvent(x.a.SUBSCRIPTION_OVERVIEW_INTERVAL_CONFIRM),!this.locked&&this._paymentIntervalChange&&this.productChangeService.confirmSubscriptionChange(this._paymentIntervalChange)}}return t.\u0275fac=function(e){return new(e||t)(k.Ob($.e),k.Ob(K.a),k.Ob(X.a),k.Ob(at.a))},t.\u0275cmp=k.Ib({type:t,selectors:[["app-manage-payment-interval"]],inputs:{currentlySubscribedInterval:"currentlySubscribedInterval",paymentIntervalChange:"paymentIntervalChange"},decls:18,vars:12,consts:[[1,"wiz-card","mt-2","p-2","pr-4"],["aria-labelledby","example-radio-group-label",1,"example-radio-group",3,"ngModel","ngModelChange"],[1,"d-flex","flex-column","align-items-start","p-4"],[1,"pb-2"],["color","primary",3,"value"],[3,"locked","confirmed"],["spinner",""],[3,"diameter"]],template:function(t,e){1&t&&(k.Ub(0,"div",0),k.Ub(1,"mat-radio-group",1),k.gc("ngModelChange",(function(t){return e.selectedPaymentInterval=t})),k.Ub(2,"div",2),k.Ub(3,"div",3),k.Ub(4,"mat-radio-button",4),k.Pc(5),k.lc(6,"translate"),k.Tb(),k.Tb(),k.Ub(7,"div",3),k.Ub(8,"mat-radio-button",4),k.Pc(9),k.lc(10,"translate"),k.Tb(),k.Tb(),k.Ub(11,"div"),k.Pc(12),k.Tb(),k.Ub(13,"div"),k.Pc(14),k.Tb(),k.Tb(),k.Tb(),k.Ub(15,"app-confirm-button",5),k.gc("confirmed",(function(){return e.onConfirm()})),k.Tb(),k.Tb(),k.Nc(16,pt,2,1,"ng-template",null,6,k.Oc)),2&t&&(k.Bb(1),k.rc("ngModel",e.selectedPaymentInterval),k.Bb(3),k.rc("value",e.PlanPaymentInterval.YEARLY),k.Bb(1),k.Rc(" ",k.mc(6,8,"subscription.billingPeriod.yearly.title")," "),k.Bb(3),k.rc("value",e.PlanPaymentInterval.MONTHLY),k.Bb(1),k.Rc(" ",k.mc(10,10,"subscription.billingPeriod.monthly.title")," "),k.Bb(3),k.Qc(e.costText),k.Bb(2),k.Qc(e.changeDateText),k.Bb(1),k.rc("locked",e.locked))},directives:[ot.c,st.q,st.t,ot.b,dt.a,lt.b],pipes:[$.d],styles:[".wiz-card-outer-wrapper[_ngcontent-%COMP%]{overflow:auto;max-height:100vh}.wiz-card-outer[_ngcontent-%COMP%]{height:750px;width:1070px;padding:15px;border-radius:32px;background-color:var(--background-color-offset)}.wiz-card[_ngcontent-%COMP%]{border-radius:24px;background:var(--overview-background);margin-top:22px;padding:22px 32px 10px 23px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start}.wiz-field[_ngcontent-%COMP%]{height:56px;width:484px;border-radius:8px;background-color:#34180e}.wiz-text[_ngcontent-%COMP%]{height:32px;width:216px;color:#000;font-family:Montserrat sans-serif;font-weight:700}.step-header[_ngcontent-%COMP%], .wiz-text[_ngcontent-%COMP%]{font-size:24px;line-height:32px}.wiz-input[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:16px;border-width:2px;border-radius:8px;border-style:solid;max-width:484px;height:56px}.wiz-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent;border:none;width:100%;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px;opacity:.6;color:var(--color);outline:none}.payment-input[_ngcontent-%COMP%]   .wiz-input-headline[_ngcontent-%COMP%]{display:none!important}#payment-method-step[_ngcontent-%COMP%]   .wiz-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:sans-serif;opacity:1;font-weight:unset;color:#000}.wiz-short-input[_ngcontent-%COMP%]{width:35px!important}.wiz-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline-width:0}.invalid-field[_ngcontent-%COMP%]{border-color:#d8110d}mat-icon.valid[_ngcontent-%COMP%]{color:green!important}mat-icon.invalid[_ngcontent-%COMP%]{color:#d8110d}.confirmation-input[_ngcontent-%COMP%]{width:200px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.wiz-payment-methods[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#ff5c20;margin-right:20px}.wiz-payment-details-container[_ngcontent-%COMP%]{width:500px}.wiz-multiline-block[_ngcontent-%COMP%]{text-align:right;line-height:1}.mat-spinner[_ngcontent-%COMP%]{margin-right:5px}.mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}.mat-spinner.small-spinner[_ngcontent-%COMP%]     circle{stroke:#000}.wiz-payment-method-status[_ngcontent-%COMP%]{padding-top:15px}.wiz-payment-method-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:green;vertical-align:middle}.wiz-coupon-hint[_ngcontent-%COMP%]{font-size:.9em;color:#e40c0c}.wiz-coupon-cost-text[_ngcontent-%COMP%]{min-width:200px;display:inline-block;text-align:right}.terms-link[_ngcontent-%COMP%]{font-weight:700}.vertical-center[_ngcontent-%COMP%]{display:flex;align-items:center}.line-through[_ngcontent-%COMP%]{text-decoration:line-through}.payment-method-created-icon[_ngcontent-%COMP%]{font-size:3em}.payment-input[_ngcontent-%COMP%]{background-color:var(--background-color-for-dark-text-input)}.sepa-checkbox-container[_ngcontent-%COMP%]{margin-top:25px;height:60px;padding-left:15px}.trust-badge[_ngcontent-%COMP%]   #ssl-badge[_ngcontent-%COMP%]{height:60px}.trust-badge[_ngcontent-%COMP%]   #dsgvo-badge[_ngcontent-%COMP%]{height:81px}.trust-badge[_ngcontent-%COMP%]   #refund-badge[_ngcontent-%COMP%]{height:87px}.manage-interval-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:24px}"]}),t})();function bt(t,e){if(1&t){const t=k.Vb();k.Ub(0,"span",23),k.gc("click",(function(){k.Ec(t);const e=k.kc(2).ngIf;return k.kc().undoCancellation(e.subscription)})),k.Pc(1),k.lc(2,"translate"),k.Tb()}2&t&&(k.Bb(1),k.Qc(k.mc(2,1,"subscription.undo")))}function ut(t,e){if(1&t&&(k.Ub(0,"div",7),k.Ub(1,"div",21),k.Pc(2),k.Nc(3,bt,3,3,"span",22),k.lc(4,"async"),k.Tb(),k.Tb()),2&t){const t=k.kc().ngIf,e=k.kc();k.Bb(2),k.Rc(" ",e.getRenewalText(t)," "),k.Bb(1),k.rc("ngIf",(null==t.subscription.nextState?null:t.subscription.nextState.planId)!==t.subscription.currentState.planId&&!k.mc(4,2,e.isTrial$))}}const ht=function(t,e){return{used:t,available:e}};function ft(t,e){if(1&t&&(k.Ub(0,"div",25),k.Ub(1,"div",10),k.Ub(2,"div",7),k.Ub(3,"div",8),k.Ub(4,"div",7),k.Ub(5,"div",26),k.Pc(6),k.lc(7,"translate"),k.Tb(),k.Ub(8,"div",27),k.Pc(9),k.lc(10,"translate"),k.Tb(),k.Tb(),k.Tb(),k.Ub(11,"div",10),k.Pb(12,"mat-progress-bar",28),k.Tb(),k.Tb(),k.Tb(),k.Tb()),2&t){const t=k.kc(2).ngIf,e=k.kc();k.Bb(6),k.Qc(k.mc(7,3,"subscription.storage.title")),k.Bb(3),k.Rc("",k.nc(10,5,"subscription.usedStorage",k.xc(8,ht,e.getGbString(t.storageData.usedGbs),e.getGbString(t.storageData.availableGbs)))," "),k.Bb(3),k.rc("value",t.storageData.gbPercentage)}}function mt(t,e){if(1&t&&(k.Ub(0,"div",10),k.Nc(1,ft,13,11,"div",24),k.Tb()),2&t){const t=k.kc().ngIf;k.Bb(1),k.rc("ngIf",t.companyLimits)}}function vt(t,e){if(1&t&&(k.Pb(0,"app-manage-company-employees",39),k.lc(1,"async")),2&t){const t=k.kc(2).ngIf,e=k.kc();k.rc("employeeChanges",k.mc(1,2,e.employeesChange$))("subscribedEmployees",t.subscription)}}function Pt(t,e){1&t&&(k.Ub(0,"mat-icon"),k.Pc(1,"edit"),k.Tb())}function xt(t,e){1&t&&(k.Ub(0,"mat-icon"),k.Pc(1,"close"),k.Tb())}function Ot(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",29),k.Ub(1,"div",10),k.Ub(2,"div",30),k.Ub(3,"div",7),k.Ub(4,"div",26),k.Pc(5),k.lc(6,"translate"),k.Tb(),k.Ub(7,"div",14),k.Ub(8,"div",31),k.Ub(9,"div",32),k.Pc(10),k.Tb(),k.Pb(11,"div",33),k.Ub(12,"div",34),k.Pc(13),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Nc(14,vt,2,4,"app-manage-company-employees",35),k.Tb(),k.Tb(),k.Ub(15,"div",36),k.Ub(16,"div",37),k.gc("click",(function(){return k.Ec(t),k.kc(2).toggleEditUser()})),k.Nc(17,Pt,2,0,"mat-icon",38),k.Nc(18,xt,2,0,"mat-icon",38),k.Tb(),k.Tb(),k.Tb()}if(2&t){const t=k.kc().ngIf,e=k.kc();k.Bb(5),k.Qc(k.mc(6,7,"subscription.licensesNumber.title")),k.Bb(5),k.Qc(t.numberOfUsers),k.Bb(3),k.Qc(e.getLicensesChangeText(t.subscription)),k.Bb(1),k.rc("ngIf",e.editUser),k.Bb(2),k.rc("appTrack",e.editUser?e.TrackEventType.SUBSCRIPTION_OVERVIEW_LICENSES_CLOSE:e.TrackEventType.SUBSCRIPTION_OVERVIEW_LICENSES_OPEN),k.Bb(1),k.rc("ngIf",!e.editUser),k.Bb(1),k.rc("ngIf",e.editUser)}}function Ct(t,e){1&t&&(k.Ub(0,"div",45),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t&&(k.Bb(1),k.Qc(k.mc(2,1,"subscription.billingPeriod.discount")))}function Tt(t,e){if(1&t&&(k.Pb(0,"app-manage-payment-interval",46),k.lc(1,"async")),2&t){const t=k.kc(2).ngIf,e=k.kc();k.rc("currentlySubscribedInterval",t.plan.paymentInterval)("paymentIntervalChange",k.mc(1,2,e.paymentIntervalChange$))}}function yt(t,e){1&t&&(k.Ub(0,"mat-icon"),k.Pc(1,"edit"),k.Tb())}function Ut(t,e){1&t&&(k.Ub(0,"mat-icon"),k.Pc(1,"close"),k.Tb())}function _t(t,e){if(1&t&&(k.Ub(0,"div",47),k.Ub(1,"div",10),k.Ub(2,"div",48),k.Ub(3,"div",12),k.Ub(4,"div",32),k.Ub(5,"div"),k.Pc(6),k.lc(7,"translate"),k.Tb(),k.Ub(8,"div",49),k.Pc(9),k.lc(10,"translate"),k.Tb(),k.Tb(),k.Ub(11,"div",10),k.Ub(12,"div",31),k.Ub(13,"div",32),k.Pc(14),k.Tb(),k.Pb(15,"div",33),k.Ub(16,"div",34),k.Pc(17),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Ub(18,"div",14),k.Pb(19,"div",50),k.Tb(),k.Tb()),2&t){const t=k.kc(2).ngIf;k.Bb(6),k.Qc(k.mc(7,4,"subscription.cost.title")),k.Bb(3),k.Qc(k.mc(10,6,"subscription.cost.vat-hint")),k.Bb(5),k.Qc(t.price),k.Bb(3),k.Qc(t.pricePerUser)}}function It(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",29),k.Ub(1,"div",10),k.Ub(2,"div",30),k.Ub(3,"div",12),k.Ub(4,"div",32),k.Ub(5,"div"),k.Pc(6),k.lc(7,"translate"),k.Tb(),k.Nc(8,Ct,3,3,"div",40),k.Tb(),k.Ub(9,"div",10),k.Ub(10,"div",31),k.Ub(11,"div",32),k.Pc(12),k.lc(13,"translate"),k.Tb(),k.Pb(14,"div",33),k.Ub(15,"div",34),k.Pc(16),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Nc(17,Tt,2,4,"app-manage-payment-interval",41),k.Tb(),k.Tb(),k.Ub(18,"div",42),k.Ub(19,"div",43),k.gc("click",(function(){return k.Ec(t),k.kc(2).toggleEditPaymentInterval()})),k.Nc(20,yt,2,0,"mat-icon",38),k.Nc(21,Ut,2,0,"mat-icon",38),k.Tb(),k.Tb(),k.Tb(),k.Nc(22,_t,20,8,"div",44)}if(2&t){const t=k.kc().ngIf,e=k.kc();k.Bb(6),k.Qc(k.mc(7,9,"subscription.billingPeriod.title")),k.Bb(2),k.rc("ngIf",t.plan.paymentInterval===e.PlanPaymentInterval.MONTHLY),k.Bb(4),k.Qc(k.mc(13,11,"subscription.billingPeriod."+t.plan.paymentInterval.toLowerCase()+".title")),k.Bb(4),k.Qc(e.getPaymentIntervalChangeText(t.subscription,t.allProducts)),k.Bb(1),k.rc("ngIf",e.editPaymentInterval),k.Bb(2),k.rc("appTrack",e.editPaymentInterval?e.TrackEventType.SUBSCRIPTION_OVERVIEW_INTERVAL_CLOSE:e.TrackEventType.SUBSCRIPTION_OVERVIEW_INTERVAL_OPEN),k.Bb(1),k.rc("ngIf",!e.editPaymentInterval),k.Bb(1),k.rc("ngIf",e.editPaymentInterval),k.Bb(1),k.rc("ngIf",t.billingDetails)}}function Mt(t,e){if(1&t&&(k.Ub(0,"div",27),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t){const t=e.ngIf;k.Bb(1),k.Rc("",k.mc(2,1,"subscription.paymentMethod."+t)," ")}}function wt(t,e){if(1&t&&(k.Ub(0,"div",51),k.Ub(1,"div",9),k.Ub(2,"div",7),k.Ub(3,"div",32),k.Pc(4),k.lc(5,"translate"),k.Tb(),k.Ub(6,"div",10),k.Ub(7,"div",31),k.Ub(8,"div",27),k.Pc(9),k.Tb(),k.Pb(10,"div",33),k.Ub(11,"div",27),k.Pc(12),k.Tb(),k.Pb(13,"div",33),k.Ub(14,"div",27),k.Pc(15),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Ub(16,"div",51),k.Ub(17,"div",9),k.Ub(18,"div",7),k.Ub(19,"div",32),k.Pc(20),k.lc(21,"translate"),k.Tb(),k.Ub(22,"div",10),k.Ub(23,"div",31),k.Nc(24,Mt,3,3,"div",52),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb()),2&t){const t=k.kc().ngIf;k.Bb(4),k.Qc(k.mc(5,6,"subscription.billingDetails")),k.Bb(5),k.Qc(null==t.billingDetails?null:t.billingDetails.billing.email),k.Bb(3),k.Qc(null==t.billingDetails?null:t.billingDetails.billing.company),k.Bb(3),k.Qc(null==t.billingDetails?null:t.billingDetails.billing.address.line1),k.Bb(5),k.Qc(k.mc(21,8,"subscription.paymentMethod.title")),k.Bb(4),k.rc("ngIf",t.billingDetails.paymentMethod)}}function St(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",7),k.Ub(1,"div",8),k.Ub(2,"div",9),k.Ub(3,"div",7),k.Ub(4,"div",10),k.Ub(5,"div",7),k.Ub(6,"div",11),k.Pc(7),k.lc(8,"translate"),k.Tb(),k.Tb(),k.Ub(9,"div",12),k.Ub(10,"div",13),k.Pc(11),k.Tb(),k.Tb(),k.Nc(12,ut,5,4,"div",6),k.Tb(),k.Ub(13,"div",14),k.Ub(14,"button",15),k.Pc(15),k.lc(16,"translate"),k.Tb(),k.Tb(),k.Tb(),k.Ub(17,"div",7),k.Nc(18,mt,2,1,"ng-template",16),k.Ub(19,"div",17),k.Ub(20,"div",18),k.gc("click",(function(){return k.Ec(t),k.kc().openStorageOptions()})),k.Pc(21),k.lc(22,"translate"),k.Tb(),k.Tb(),k.Tb(),k.Nc(23,Ot,19,9,"div",19),k.lc(24,"async"),k.Nc(25,It,23,13,"ng-template",20),k.lc(26,"async"),k.Tb(),k.Tb(),k.Nc(27,wt,25,10,"ng-template",20),k.Tb()}if(2&t){const t=e.ngIf,n=k.kc();k.Bb(7),k.Qc(k.mc(8,9,"subscription.title")),k.Bb(4),k.Qc(t.product.name),k.Bb(1),k.rc("ngIf",t.subscription),k.Bb(2),k.rc("appTrack",n.TrackEventType.SUBSCRIPTION_OVERVIEW_AVAILABLE_SUBSCRIPTIONS),k.Bb(1),k.Rc(" ",k.mc(16,11,"subscription.available")," "),k.Bb(6),k.Qc(k.mc(22,13,"subscription.upgradeStorage")),k.Bb(2),k.rc("ngIf",t.numberOfUsers&&!k.mc(24,15,n.isTrial$)),k.Bb(2),k.rc("ngIf",t.subscription&&!k.mc(26,17,n.isTrial$)),k.Bb(2),k.rc("ngIf",t.billingDetails)}}let kt=(()=>{class t{constructor(t,e,n,i,c,r,d,l,p,g,b,u){this.subscriptionService=t,this.companyService=e,this.authService=n,this.profileService=i,this.productService=c,this.productChangeService=r,this.subscriptionChangeTranslationService=d,this.translate=l,this.decimalPipe=p,this.hotjarTrackingService=g,this.dialog=b,this.store=u,this.PlanPaymentInterval=a.PlanPaymentInterval,this.companyLimits$=this.store.select(O.i),this.subscription$=new o.a(null),this.billingDetails$=new o.a(null),this.products$=this.store.select(S),this.editUser=!1,this.editPaymentInterval=!1,this.TrackEventType=x.a,this.onDestroy$=new s.a,this.loading=!0}ngOnInit(){this.setupCompany(),this.setupSubscription(),this.setupOverviewData(),this.setupBillingDetails(),this.setupPaymentIntervalChange(),this.setupEmployeesChange(),this.setupTrial()}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}setupCompany(){const t=this.authService.$authState.pipe(Object(l.a)(t=>!!t),Object(p.a)(t=>this.profileService.getProfile(t.uid)),Object(g.a)());this.company$=t.pipe(Object(p.a)(t=>this.companyService.getCompany(t.company)),Object(g.a)())}setupSubscription(){this.subscriptionService.getActiveSubscription().pipe(Object(b.a)(this.onDestroy$)).subscribe(t=>{this.subscription$.next(t)})}setupBillingDetails(){this.subscriptionService.getActiveSubscriptionAndProduct().pipe(Object(l.a)(([t,e])=>t&&e.type!==a.ProductType.TRIAL),Object(u.a)(([t])=>this.subscriptionService.getBillingInformation(t.id)),Object(l.a)(t=>!!t),Object(b.a)(this.onDestroy$)).subscribe(t=>this.billingDetails$.next(t))}setupOverviewData(){this.overviewData$=Object(d.b)([this.company$,this.subscription$,this.companyLimits$,this.products$,this.billingDetails$]).pipe(Object(u.a)(t=>Object(r.a)(this,void 0,void 0,(function*(){const[e,n,i,c,r]=t,o=c.filter(t=>t.type===a.ProductType.SUBSCRIPTION||t.type===a.ProductType.TRIAL),s={company:e,product:c.sort((t,e)=>t.grade-e.grade)[0],allProducts:c};if(i){const t=Bt(e,i);s.companyLimits=i,s.storageData=t}if(n){const t=[];c.filter(t=>t.plans).forEach(e=>t.push(...e.plans));const e=t.find(t=>t.stripeId===n.currentState.planId),i=o.find(t=>t.plans.find(t=>t===e)),a=n.currentState.quantity;let d,l;if(r){const t=yield this.subscriptionService.getOrLoadCouponResponse(e.stripeId);d=this.getPrice(a,e,r,t,n.renewalDate),l=this.getPricePerUser(a,e,r,t,n.renewalDate)}s.plan=e,s.product=i,s.allProducts=c,s.price=d,s.pricePerUser=l,s.subscription=n,s.numberOfUsers=a,s.billingDetails=r}return s}))))}setupPaymentIntervalChange(){this.paymentIntervalChange$=this.productChangeService.getProductChanges().pipe(Object(l.a)(t=>t.changeType===m.a.PAYMENT_INTERVAL),Object(h.a)(t=>t),Object(f.a)(t=>{t.status===v.a.CONFIRMED&&(this.editPaymentInterval=!1)}))}setupEmployeesChange(){this.employeesChange$=this.productChangeService.getProductChanges().pipe(Object(l.a)(t=>t.changeType===m.a.EMPLOYEES_CHANGE),Object(h.a)(t=>t),Object(f.a)(t=>{t.status===v.a.CONFIRMED&&(this.editUser=!1)}))}getRenewalText(t){return this.subscriptionChangeTranslationService.getProductChangeText(t.product,t.allProducts,t.subscription)}getPrice(t,e,n,i,c){const r=e.paymentInterval===a.PlanPaymentInterval.MONTHLY?"months":"years",o=V.a.unix(c).subtract(1,r).unix(),s=Object(P.s)(n.billing.address.country,e,o),d=Object(P.e)(e,t,s,{response:i,ignoreValid:!0}),l=e.paymentInterval.toLowerCase(),p=this.subscriptionChangeTranslationService.getCurrencyCostText(d);return this.translate.instant("subscription.cost."+l,{cost:p})}getPricePerUser(t,e,n,i,c){const r=e.paymentInterval.toLowerCase(),o=e.paymentInterval===a.PlanPaymentInterval.MONTHLY?"months":"years",s=V.a.unix(c).subtract(1,o).unix(),d=Object(P.s)(n.billing.address.country,e,s),l=Object(P.e)(e,t,d,{response:i,ignoreValid:!0}),p=Object(P.l)(l,t),g=this.subscriptionChangeTranslationService.getCurrencyCostText(p);return this.translate.instant("subscription.cost.perUser."+r,{cost:g})}getGbString(t){return this.decimalPipe.transform(t,"1.2-2")}getPaymentIntervalChangeText(t,e){return this.subscriptionChangeTranslationService.getPaymentIntervalChangeText(t,e)}getLicensesChangeText(t){return this.subscriptionChangeTranslationService.getLicensesChangeText(t)}toggleEditUser(){this.editUser=!this.editUser}toggleEditPaymentInterval(){this.editPaymentInterval=!this.editPaymentInterval}undoCancellation(t){this.subscriptionService.undoPlanChange(t)}setupTrial(){this.isTrial$=this.overviewData$.pipe(Object(h.a)(t=>t.product.type===a.ProductType.TRIAL))}openStorageOptions(){this.dialog.open(Q,{width:"1190px",panelClass:"storage-upgrade-dialog"})}}return t.\u0275fac=function(e){return new(e||t)(k.Ob(W.b),k.Ob(q.a),k.Ob(H.a),k.Ob(Y.a),k.Ob(Z.a),k.Ob(K.a),k.Ob(X.a),k.Ob($.e),k.Ob(i.f),k.Ob(J.a),k.Ob(B.b),k.Ob(C.h))},t.\u0275cmp=k.Ib({type:t,selectors:[["app-subscription"]],features:[k.Ab([i.f])],decls:9,vars:3,consts:[[1,"row","justify-content-center","h-100","overflow-auto"],[1,"mt-4","col-1"],[1,"row","justify-content-center"],["href","#","routerLink","/settings",1,"col-2","mt-1"],[1,"material-icons"],[1,"col-10","my-4"],["class","row",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"cf-card"],[1,"col"],[1,"col","cf-text","cf-text-1"],[1,"row","align-items-center"],[1,"col-auto","cf-h1"],[1,"col-auto"],["color","primary","routerLink","./products","mat-flat-button","",3,"appTrack"],["appFeatureFlag","feature_company_storage"],[1,"col-auto","upgrade-storage"],[1,"d-flex","mt-1","h-100","align-items-end","pointer",3,"click"],["class","row mt-3",4,"ngIf"],[3,"ngIf"],[1,"col","cf-text","cf-text-2"],["class","undo-link pointer",3,"click",4,"ngIf"],[1,"undo-link","pointer",3,"click"],["class","row align-items-end mt-4",4,"ngIf"],[1,"row","align-items-end","mt-4"],[1,"col","cf-h2"],[1,"col-auto","cf-text","cf-text-1"],["color","primary","mode","determinate",3,"value"],[1,"row","mt-3"],[1,"cf-form-field","lg-pad"],[1,"row","justify-content-end"],[1,"col-auto","cf-h2"],[1,"w-100"],[1,"col-auto","cf-text","cf-text-2"],["fromSubscriptionOverview","true",3,"employeeChanges","subscribedEmployees",4,"ngIf"],[1,"col-auto","pointer","pt-2"],[1,"cf-icon-placeholder",3,"appTrack","click"],[4,"ngIf"],["fromSubscriptionOverview","true",3,"employeeChanges","subscribedEmployees"],["class","cf-text cf-text-2",4,"ngIf"],[3,"currentlySubscribedInterval","paymentIntervalChange",4,"ngIf"],[1,"col-auto","pt-2"],[1,"cf-icon-placeholder","pointer",3,"appTrack","click"],["class","row align-items-center mt-3",4,"ngIf"],[1,"cf-text","cf-text-2"],[3,"currentlySubscribedInterval","paymentIntervalChange"],[1,"row","align-items-center","mt-3"],[1,"cf-form-field","sm-pad"],[1,"w-50","cf-text","cf-text-2"],[1,"cf-icon-placeholder"],[1,"col-12","mt-3"],["class","col-auto cf-text cf-text-1",4,"ngIf"]],template:function(t,e){1&t&&(k.Ub(0,"div",0),k.Ub(1,"div",1),k.Ub(2,"div",2),k.Ub(3,"a",3),k.Ub(4,"i",4),k.Pc(5,"arrow_back"),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Ub(6,"div",5),k.Nc(7,St,28,19,"div",6),k.lc(8,"async"),k.Tb(),k.Tb()),2&t&&(k.Bb(7),k.rc("ngIf",k.mc(8,1,e.overviewData$)))},directives:[c.k,i.p,tt.b,c.i,et.a,nt.a,it.a,ct.a,N.a,gt],pipes:[i.b,$.d],styles:[".footerfix[_ngcontent-%COMP%]{padding:0 0 6em;overflow:auto}.settings-other[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{height:24px;width:24px}.delete[_ngcontent-%COMP%]{background:#d12c3f}h2[_ngcontent-%COMP%]{font-size:24px;font-family:Archive,sans-serif}.theme-item[_ngcontent-%COMP%]{font-size:.9em;padding:4px 28px}footer[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;left:0;padding:1rem}.cf-text[_ngcontent-%COMP%]{opacity:.6;color:var(--overview-font);font-family:Montserrat,sans-serif;font-weight:500;font-size:24px;line-height:32px}.cf-text-upcoming[_ngcontent-%COMP%]{opacity:.4}.cf-text-1[_ngcontent-%COMP%]{font-size:16px;line-height:24px}.cf-text-2[_ngcontent-%COMP%]{font-size:12px;line-height:20px}.cf-text-italic[_ngcontent-%COMP%]{font-size:16px;font-style:italic;font-weight:500;line-height:24px}.cf-h1[_ngcontent-%COMP%]{color:var(--overview-font);font-family:Montserrat,sans-serif;font-size:24px;font-weight:700;line-height:32px}.cf-h2[_ngcontent-%COMP%]{color:var(--overview-font)}.cf-button[_ngcontent-%COMP%], .cf-h2[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px}.cf-button[_ngcontent-%COMP%]{color:#ff5c20;padding:6px 12px}button[mat-flat-button][_ngcontent-%COMP%]{padding:12px 24px;border-radius:24px;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px}.cf-form-field[_ngcontent-%COMP%]{padding:0 32px;border-radius:16px;background-color:var(--overview-line-background)}.cf-form-field.sm-pad[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px}.cf-form-field.lg-pad[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px}.cf-icon-placeholder[_ngcontent-%COMP%]{width:24px}mat-progress-bar[_ngcontent-%COMP%]{margin-top:16px}.mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}.spinner-container[_ngcontent-%COMP%]{padding:7px 35px}",".cf-card[_ngcontent-%COMP%]{background:var(--overview-background);border-radius:24px;padding:32px 48px}.undo-link[_ngcontent-%COMP%]{text-decoration:underline;text-underline:var(--overview-font);font-weight:bolder}.upgrade-storage[_ngcontent-%COMP%]{color:var(--app-primary);font-weight:700;font-size:16px}mat-icon[_ngcontent-%COMP%]{color:var(--overview-font)}"]}),t})();const Bt=(t,e)=>{const n=e.storageGBytes||0,i=(t.storageBytes||0)/1e9;return{availableGbs:n,usedGbs:i,gbPercentage:i/n*100}};var Nt=n("MQuO"),jt=n("IzEk"),Rt=n("0885"),Dt=n("SQ63"),Et=n("GuDp");function zt(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",5),k.gc("click",(function(){k.Ec(t);const n=e.index;return k.kc().itemSelected(n)})),k.Pc(1),k.lc(2,"translate"),k.Tb()}if(2&t){const t=e.$implicit,n=e.index,i=k.kc();k.Gb("option-selected",i.selectedToggleIndex===n)("option-unselected",i.selectedToggleIndex!==n),k.Bb(1),k.Rc(" ",k.mc(2,5,t.translateKey)," ")}}let Gt=(()=>{class t{constructor(){this.selected=new k.n}itemSelected(t){this.selected.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=k.Ib({type:t,selectors:[["app-toggle"]],inputs:{items:"items",selectedToggleIndex:"selectedToggleIndex"},outputs:{selected:"selected"},decls:7,vars:4,consts:[[1,"outer-wrapper","d-flex","flex-column","align-items-center"],[1,"wrapper"],[1,"row"],["class","col option",3,"option-selected","option-unselected","click",4,"ngFor","ngForOf"],[1,"pt-2","note"],[1,"col","option",3,"click"]],template:function(t,e){1&t&&(k.Ub(0,"div",0),k.Ub(1,"div",1),k.Ub(2,"div",2),k.Nc(3,zt,3,7,"div",3),k.Tb(),k.Tb(),k.Ub(4,"div",4),k.Pc(5),k.lc(6,"translate"),k.Tb(),k.Tb()),2&t&&(k.Bb(3),k.rc("ngForOf",e.items),k.Bb(2),k.Rc(" ",k.mc(6,2,"subscription.billingPeriod.twoFreeMonthNote")," "))},directives:[i.o],pipes:[$.d],styles:[".wrapper[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px;border-radius:24px;background:rgba(52,24,14,.4);width:250px}.note[_ngcontent-%COMP%]{opacity:1;color:#ff5722;font-weight:bolder;line-height:20px;width:100%}.note[_ngcontent-%COMP%], .option[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-size:16px;text-align:center}.option[_ngcontent-%COMP%]{cursor:pointer;padding:8px 24px;font-weight:700;line-height:24px}.option-selected[_ngcontent-%COMP%]{color:#34180e;border-radius:24px;background-color:#f1eeed}.option-unselected[_ngcontent-%COMP%]{color:#fff}"]}),t})();function $t(t,e){1&t&&k.Qb(0)}function At(t,e){1&t&&k.Qb(0)}function Lt(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",3),k.Ub(1,"div",4),k.Ub(2,"button",5),k.gc("click",(function(){return k.Ec(t),k.kc().onClick()})),k.Nc(3,$t,1,0,"ng-container",6),k.Nc(4,At,1,0,"ng-container",6),k.Tb(),k.Tb(),k.Tb()}if(2&t){const t=k.kc(),e=k.Ac(2),n=k.Ac(4);k.Bb(3),k.rc("ngIf",t.productChangeType===t.SubscriptionChangeDirection.DOWNGRADE)("ngIfThen",e),k.Bb(1),k.rc("ngIf",t.productChangeType===t.SubscriptionChangeDirection.UPGRADE)("ngIfThen",n)}}function Qt(t,e){1&t&&(k.Pc(0),k.lc(1,"translate")),2&t&&k.Rc(" ",k.mc(1,1,"subscription.plans.downgrade.title"),"\n")}function Ft(t,e){1&t&&(k.Pc(0),k.lc(1,"translate")),2&t&&k.Rc(" ",k.mc(1,1,"subscription.plans.upgrade.title"),"\n")}let Vt=(()=>{class t{constructor(t){this.productChangeService=t,this.allProducts=[],this.SubscriptionChangeDirection=rt.a}set gradeOfCard(t){this._gradeOfCard=parseInt(t,10)}ngOnChanges(){this.setChangeType()}setChangeType(){let t=Object(P.d)(this.currentProductGrade,this._gradeOfCard);if(t===rt.a.UPGRADE){const t=Object(P.j)(this.allProducts).grade;return this._gradeOfCard===t?void(this.productChangeType=rt.a.UNCHANGED):void(this.productChangeType=rt.a.UPGRADE)}if(t===rt.a.DOWNGRADE){if(!this.scheduledProductGrade)return void(this.productChangeType=rt.a.UNCHANGED);t=Object(P.d)(this.scheduledProductGrade,this._gradeOfCard)}this.productChangeType=t}onClick(){this.productChangeService.scheduleProductChange(this._gradeOfCard)}}return t.\u0275fac=function(e){return new(e||t)(k.Ob(K.a))},t.\u0275cmp=k.Ib({type:t,selectors:[["app-product-change"]],inputs:{currentProductGrade:"currentProductGrade",scheduledProductGrade:"scheduledProductGrade",allProducts:"allProducts",gradeOfCard:"gradeOfCard"},features:[k.zb],decls:5,vars:1,consts:[["class","row justify-content-center mb-2",4,"ngIf"],["donwgrade",""],["upgrade",""],[1,"row","justify-content-center","mb-2"],[1,"col-auto"],["color","primary","mat-flat-button","",3,"click"],[4,"ngIf","ngIfThen"]],template:function(t,e){1&t&&(k.Nc(0,Lt,5,4,"div",0),k.Nc(1,Qt,2,3,"ng-template",null,1,k.Oc),k.Nc(3,Ft,2,3,"ng-template",null,2,k.Oc)),2&t&&k.rc("ngIf",e.productChangeType!==e.SubscriptionChangeDirection.UNCHANGED)},directives:[i.p,tt.b],pipes:[$.d],styles:["",".cf-suggested-text[_ngcontent-%COMP%]{color:#ff5c20;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px;text-align:center}.cf-change-confirmation[_ngcontent-%COMP%]{min-height:100px;border-radius:16px;border:1px solid #000}.cf-cards-container[_ngcontent-%COMP%]{position:relative;width:100%;top:5vh;display:flex;align-items:center;flex-direction:column}.coming-soon[_ngcontent-%COMP%]{size:13px;color:#927f7a}.asterisk[_ngcontent-%COMP%]{display:inline;size:13px}.products-wrapper[_ngcontent-%COMP%]{height:90vh}@media (min-width:1600px){.container[_ngcontent-%COMP%]{max-width:1400px}}@media (min-height:600px) and (max-height:1190px) and (min-width:1201px){.trust-badge-wrapper[_ngcontent-%COMP%]{height:340px}.products-wrapper[_ngcontent-%COMP%]{height:calc(100vh + 50px)}}.toggle-container[_ngcontent-%COMP%]{min-height:7vh}@media (min-height:1150px){.toggle-container[_ngcontent-%COMP%]{min-height:10vh}}"]}),t})();function Wt(t,e){}function qt(t,e){if(1&t&&k.Pb(0,"app-product-change",8),2&t){const t=k.kc();k.rc("gradeOfCard",t.gradeOfCard)("currentProductGrade",t.productState.currentProduct.grade)("scheduledProductGrade",null==t.productState.nextProduct?null:t.productState.nextProduct.grade)("allProducts",t.productState.allProducts)}}function Ht(t,e){1&t&&(k.Ub(0,"div",9),k.Ub(1,"div",10),k.Pc(2),k.lc(3,"translate"),k.Tb(),k.Tb()),2&t&&(k.Bb(2),k.Qc(k.mc(3,1,"subscription.plans.selected")))}const Yt=[[["div",8,"corner-content"]],"*"],Zt=function(t){return{"cf-card":!0,suggested:t}},Kt=["div.corner-content","*"];let Xt=(()=>{class t{constructor(){}set gradeOfCard(t){this._gradeOfCard=parseInt(t,10)}get gradeOfCard(){return this._gradeOfCard}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=k.Ib({type:t,selectors:[["app-product-card"]],inputs:{productState:"productState",gradeOfCard:"gradeOfCard"},ngContentSelectors:Kt,decls:11,vars:6,consts:[[1,"px-2"],[3,"ngClass"],[1,"corner-info","d-flex","flex-column","align-items-center","montserrat-text-light","justify-content-end"],[3,"ngIf","ngIfThen"],[1,"h-100","d-flex","flex-column","justify-content-end","align-items-center"],[1,"product-change"],[3,"gradeOfCard","currentProductGrade","scheduledProductGrade","allProducts",4,"ngIf"],["currentProduct",""],[3,"gradeOfCard","currentProductGrade","scheduledProductGrade","allProducts"],[1,"active-subscription"],[1,"montserrat-text-light","cf-text","cf-text-1","text-center"]],template:function(t,e){if(1&t&&(k.qc(Yt),k.Ub(0,"div",0),k.Ub(1,"div",1),k.Ub(2,"div",2),k.pc(3),k.Tb(),k.Nc(4,Wt,0,0,"ng-template",3),k.Ub(5,"div",4),k.pc(6,1),k.Ub(7,"div",5),k.Nc(8,qt,1,4,"app-product-change",6),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Nc(9,Ht,4,3,"ng-template",null,7,k.Oc)),2&t){const t=k.Ac(10);k.Bb(1),k.rc("ngClass",k.wc(4,Zt,e.productState.currentProduct.grade===e.gradeOfCard-1)),k.Bb(3),k.rc("ngIf",e.productState.currentProduct.grade===e.gradeOfCard)("ngIfThen",t),k.Bb(4),k.rc("ngIf",e.productState)}},directives:[i.n,i.p,Vt],pipes:[$.d],styles:[".cf-card[_ngcontent-%COMP%]{position:relative;background:var(--overview-background);border-radius:24px;padding:8px;height:380px;overflow:hidden}.cf-card[_ngcontent-%COMP%]   .active-subscription[_ngcontent-%COMP%]{margin:-8px;height:40px;display:flex;justify-content:center;align-items:center;border-radius:24px 24px 0 0;background:var(--active-card-background)}.cf-card.suggested[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 4px #ff5c20}.product-change[_ngcontent-%COMP%]{min-height:40px}.corner-info[_ngcontent-%COMP%]{position:absolute;top:-120px;right:-120px;width:200px;height:200px;background-color:#ff5c20;transform:rotate(45deg);color:#fff;line-height:1.2;padding-bottom:8px}"]}),t})();var Jt=n("vqxn");function te(t,e){if(1&t&&(k.Ub(0,"div",11),k.Pc(1),k.Tb()),2&t){const t=k.kc(2);k.Bb(1),k.Rc(" ",t.changeText.dateText,"")}}function ee(t,e){1&t&&(k.Pc(0),k.lc(1,"translate")),2&t&&k.Rc(" ",k.mc(1,1,"subscription.change.confirm")," ")}function ne(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",2),k.Ub(1,"div",3),k.Ub(2,"div",4),k.Ub(3,"div"),k.Pc(4),k.Ub(5,"span",5),k.Pc(6),k.Tb(),k.Pc(7),k.Ub(8,"span",5),k.Pc(9),k.Tb(),k.Pc(10),k.Tb(),k.Tb(),k.Ub(11,"div",4),k.Pc(12),k.Tb(),k.Nc(13,te,2,1,"div",6),k.Ub(14,"div",7),k.Ub(15,"button",8),k.gc("click",(function(){return k.Ec(t),k.kc().onConfirm()})),k.Ub(16,"div",9),k.Nc(17,ee,2,3,"ng-template",10),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb()}if(2&t){const t=k.kc(),e=k.Ac(2);k.Bb(4),k.Rc("",t.changeText.questionPartOne," "),k.Bb(2),k.Qc(t.productChange.from.product.name),k.Bb(1),k.Rc(" ",t.changeText.questionPartTwo," "),k.Bb(2),k.Qc(t.productChange.to.product.name),k.Bb(1),k.Rc(" ",t.changeText.questionPartThree,""),k.Bb(2),k.Rc(" ",t.changeText.costText,""),k.Bb(1),k.rc("ngIf",t.changeText.dateText),k.Bb(4),k.rc("ngIf",!t.locked)("ngIfElse",e)}}function ie(t,e){1&t&&(k.Ub(0,"div"),k.Pb(1,"mat-spinner",12),k.Tb()),2&t&&(k.Bb(1),k.rc("diameter",26))}let ce=(()=>{class t{constructor(t,e,n,i,c,r){this.dateService=t,this.translateService=e,this.productChangeService=n,this.subscriptionChangeTranslationService=i,this.trackingDispatcherService=c,this.localeId=r,this.locked=!1}set productChange(t){if(t&&t.changeType===m.a.PRODUCT_CHANGE){if(t.status===v.a.CONFIRMED)return this.changeText=null,void(this.locked=!1);if(t.status===v.a.PROCESSING)return this.locked=!0,void this.trackProductChange(t);this._productChange=t,this.trackProductChange(t),this.setChangeText()}}get productChange(){return this._productChange}setChangeText(){const t=this.translateService.instant("subscription.change.questionPartOne"),e=this.translateService.instant("subscription.change.questionPartTwo"),n=this.translateService.instant("subscription.change.questionPartThree"),i=this.productChange.changeDirection===rt.a.DOWNGRADE?this.productChange.subscription.renewalDate:V()().unix(),c=Object(P.s)(this.productChange.billingDetails.billing.address.country,this.productChange.to.plan,i),r=Object(P.f)(this.productChange,c),a=this.subscriptionChangeTranslationService.getCostChangeText(this.productChange,r,c),o=this.subscriptionChangeTranslationService.getDateChangeText(this.productChange);this.changeText={questionPartOne:t,questionPartTwo:e,questionPartThree:n,costText:a,dateText:o}}onConfirm(){this.productChangeService.confirmSubscriptionChange(this.productChange)}trackProductChange(t){const e=t.to.product,n=t.changeDirection,i=t.status===v.a.PROCESSING;let c,r;i&&n===rt.a.UPGRADE?c=x.a.SUBSCRIPTION_PRODUCTS_UPGRADE_CONFIRM:i||n!==rt.a.UPGRADE?i&&n===rt.a.DOWNGRADE?c=x.a.SUBSCRIPTION_PRODUCTS_DOWNGRADE_CONFIRM:i||n!==rt.a.DOWNGRADE||(c=x.a.SUBSCRIPTION_PRODUCTS_DOWNGRADE_OPEN):c=x.a.SUBSCRIPTION_PRODUCTS_UPGRADE_OPEN,c&&(0===e.grade?r="basic":1===e.grade?r="pro":2===e.grade&&(r="premium"),r&&this.trackingDispatcherService.emitTrackingEvent(c,{type:r}))}}return t.\u0275fac=function(e){return new(e||t)(k.Ob(Jt.a),k.Ob($.e),k.Ob(K.a),k.Ob(X.a),k.Ob(at.a),k.Ob(k.u))},t.\u0275cmp=k.Ib({type:t,selectors:[["app-product-confirm"]],inputs:{productChange:"productChange"},decls:3,vars:1,consts:[["class","cf-change-confirmation p-3 cf-card",4,"ngIf"],["spinner",""],[1,"cf-change-confirmation","p-3","cf-card"],[1,"d-flex","flex-column","align-items-center"],[1,"cf-text","cf-text-2","my-2"],[1,"font-weight-bold"],["class","cf-text cf-text-2",4,"ngIf"],[1,"d-flex","justify-content-center","mt-4"],["color","primary","mat-flat-button","",3,"click"],[1,"d-flex","justify-content-center"],[3,"ngIf","ngIfElse"],[1,"cf-text","cf-text-2"],[3,"diameter"]],template:function(t,e){1&t&&(k.Nc(0,ne,18,9,"div",0),k.Nc(1,ie,2,1,"ng-template",null,1,k.Oc)),2&t&&k.rc("ngIf",e.changeText)},directives:[i.p,tt.b,lt.b],pipes:[$.d],styles:[".mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}button[_ngcontent-%COMP%]{width:250px}",".cf-suggested-text[_ngcontent-%COMP%]{color:#ff5c20;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px;text-align:center}.cf-change-confirmation[_ngcontent-%COMP%]{min-height:100px;border-radius:16px;border:1px solid #000}.cf-cards-container[_ngcontent-%COMP%]{position:relative;width:100%;top:5vh;display:flex;align-items:center;flex-direction:column}.coming-soon[_ngcontent-%COMP%]{size:13px;color:#927f7a}.asterisk[_ngcontent-%COMP%]{display:inline;size:13px}.products-wrapper[_ngcontent-%COMP%]{height:90vh}@media (min-width:1600px){.container[_ngcontent-%COMP%]{max-width:1400px}}@media (min-height:600px) and (max-height:1190px) and (min-width:1201px){.trust-badge-wrapper[_ngcontent-%COMP%]{height:340px}.products-wrapper[_ngcontent-%COMP%]{height:calc(100vh + 50px)}}.toggle-container[_ngcontent-%COMP%]{min-height:7vh}@media (min-height:1150px){.toggle-container[_ngcontent-%COMP%]{min-height:10vh}}",".footerfix[_ngcontent-%COMP%]{padding:0 0 6em;overflow:auto}.settings-other[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{height:24px;width:24px}.delete[_ngcontent-%COMP%]{background:#d12c3f}h2[_ngcontent-%COMP%]{font-size:24px;font-family:Archive,sans-serif}.theme-item[_ngcontent-%COMP%]{font-size:.9em;padding:4px 28px}footer[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;left:0;padding:1rem}.cf-text[_ngcontent-%COMP%]{opacity:.6;color:var(--overview-font);font-family:Montserrat,sans-serif;font-weight:500;font-size:24px;line-height:32px}.cf-text-upcoming[_ngcontent-%COMP%]{opacity:.4}.cf-text-1[_ngcontent-%COMP%]{font-size:16px;line-height:24px}.cf-text-2[_ngcontent-%COMP%]{font-size:12px;line-height:20px}.cf-text-italic[_ngcontent-%COMP%]{font-size:16px;font-style:italic;font-weight:500;line-height:24px}.cf-h1[_ngcontent-%COMP%]{color:var(--overview-font);font-family:Montserrat,sans-serif;font-size:24px;font-weight:700;line-height:32px}.cf-h2[_ngcontent-%COMP%]{color:var(--overview-font)}.cf-button[_ngcontent-%COMP%], .cf-h2[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px}.cf-button[_ngcontent-%COMP%]{color:#ff5c20;padding:6px 12px}button[mat-flat-button][_ngcontent-%COMP%]{padding:12px 24px;border-radius:24px;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px}.cf-form-field[_ngcontent-%COMP%]{padding:0 32px;border-radius:16px;background-color:var(--overview-line-background)}.cf-form-field.sm-pad[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px}.cf-form-field.lg-pad[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px}.cf-icon-placeholder[_ngcontent-%COMP%]{width:24px}mat-progress-bar[_ngcontent-%COMP%]{margin-top:16px}.mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}.spinner-container[_ngcontent-%COMP%]{padding:7px 35px}"]}),t})();function re(t,e){if(1&t){const t=k.Vb();k.Ub(0,"div",13),k.Ub(1,"div",14),k.Ub(2,"app-toggle",15),k.gc("selected",(function(e){return k.Ec(t),k.kc().itemSelected(e)})),k.Tb(),k.Tb(),k.Tb()}if(2&t){const t=k.kc();k.Bb(2),k.rc("items",t.items)("selectedToggleIndex",t.selectedToggleIndex)}}function ae(t,e){if(1&t&&(k.Ub(0,"div",44),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t){const t=e.$implicit;k.Bb(1),k.Qc(k.mc(2,1,"subscription.plans.basic.features."+t))}}function oe(t,e){1&t&&(k.Ub(0,"div",30),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t&&(k.Bb(1),k.Qc(k.mc(2,1,"subscription.plans.discount")))}const se=function(t,e){return{"cf-text-1":t,"cf-text-italic mt-2":e}};function de(t,e){if(1&t&&(k.Ub(0,"div",45),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t){const t=e.$implicit,n=e.last;k.rc("ngClass",k.xc(4,se,!n,n)),k.Bb(1),k.Rc(" ",k.mc(2,2,"subscription.plans.pro.features."+t)," ")}}function le(t,e){1&t&&(k.Ub(0,"div",30),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t&&(k.Bb(1),k.Qc(k.mc(2,1,"subscription.plans.discount")))}function pe(t,e){if(1&t&&(k.Ub(0,"div",44),k.Pc(1),k.lc(2,"translate"),k.Tb()),2&t){const t=e.$implicit;k.Bb(1),k.Rc(" ",k.mc(2,1,"subscription.plans.premium.features."+t)," ")}}function ge(t,e){if(1&t&&(k.Ub(0,"div",46),k.Pc(1),k.lc(2,"translate"),k.Ub(3,"div",47),k.Pc(4," *"),k.Tb(),k.Tb()),2&t){const t=e.$implicit;k.Bb(1),k.Rc(" ",k.mc(2,1,"subscription.plans.premium.upcomingFeatures."+t)," ")}}const be=function(){return[0,1,2]},ue=function(t){return{cost:t}},he=function(){return[0,1,2,3]},fe=function(){return[]};function me(t,e){if(1&t&&(k.Ub(0,"div",16),k.Ub(1,"div",17),k.Ub(2,"div",18),k.Ub(3,"div",19),k.Ub(4,"app-product-card",20),k.Ub(5,"div",21),k.Pc(6,"5 GB"),k.Tb(),k.Ub(7,"div",22),k.Pc(8),k.lc(9,"translate"),k.Tb(),k.Ub(10,"div",23),k.Ub(11,"div",24),k.Pc(12),k.lc(13,"translate"),k.Tb(),k.Tb(),k.Ub(14,"div",18),k.Ub(15,"div",25),k.Pc(16),k.lc(17,"translate"),k.Tb(),k.Tb(),k.Ub(18,"div",26),k.Nc(19,ae,3,3,"div",27),k.Tb(),k.Tb(),k.Tb(),k.Ub(20,"div",19),k.Ub(21,"app-product-card",28),k.Ub(22,"div",21),k.Pc(23,"10 GB"),k.Tb(),k.Ub(24,"div",22),k.Pc(25),k.lc(26,"translate"),k.Tb(),k.Ub(27,"div",23),k.Ub(28,"div",24),k.Pc(29),k.lc(30,"translate"),k.Tb(),k.Tb(),k.Ub(31,"div",18),k.Ub(32,"div",25),k.Pc(33),k.lc(34,"translate"),k.Tb(),k.Tb(),k.Ub(35,"div",29),k.Ub(36,"div",30),k.Pc(37),k.lc(38,"translate"),k.Tb(),k.Nc(39,oe,3,3,"div",31),k.Tb(),k.Ub(40,"div",29),k.Nc(41,de,3,7,"div",32),k.Tb(),k.Tb(),k.Tb(),k.Ub(42,"div",19),k.Ub(43,"app-product-card",33),k.Ub(44,"div",21),k.Pc(45,"25 GB"),k.Tb(),k.Ub(46,"div",22),k.Pc(47),k.lc(48,"translate"),k.Tb(),k.Ub(49,"div",34),k.Ub(50,"div",35),k.Pc(51),k.lc(52,"translate"),k.Tb(),k.Tb(),k.Ub(53,"div",36),k.Ub(54,"div",24),k.Pc(55),k.lc(56,"translate"),k.Tb(),k.Tb(),k.Ub(57,"div",18),k.Ub(58,"div",25),k.Pc(59),k.lc(60,"translate"),k.Tb(),k.Tb(),k.Ub(61,"div",29),k.Ub(62,"div",30),k.Pc(63),k.lc(64,"translate"),k.Tb(),k.Nc(65,le,3,3,"div",31),k.Tb(),k.Pb(66,"div",18),k.Ub(67,"div",29),k.Nc(68,pe,3,3,"div",27),k.Nc(69,ge,5,3,"div",37),k.Ub(70,"div",38),k.Pc(71),k.lc(72,"translate"),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Ub(73,"div",7),k.Ub(74,"div",39),k.Ub(75,"div",40),k.Pc(76),k.lc(77,"translate"),k.Tb(),k.Tb(),k.Tb(),k.Ub(78,"div",41),k.Ub(79,"div",42),k.Pb(80,"app-product-confirm",43),k.lc(81,"async"),k.Tb(),k.Tb(),k.Tb(),k.Tb()),2&t){const t=e.ngIf,n=k.kc();k.Bb(4),k.rc("productState",t),k.Bb(4),k.Qc(k.mc(9,24,"subscription.storage.perCompany")),k.Bb(4),k.Qc(k.mc(13,26,"subscription.plans.basic.title")),k.Bb(4),k.Qc(k.mc(17,28,"subscription.plans.basic.costs")),k.Bb(3),k.rc("ngForOf",k.vc(56,be)),k.Bb(2),k.rc("productState",t),k.Bb(4),k.Qc(k.mc(26,30,"subscription.storage.perUser")),k.Bb(4),k.Qc(k.mc(30,32,"subscription.plans.pro.title")),k.Bb(4),k.Qc(k.nc(34,34,"subscription.plans.costs",k.wc(57,ue,n.getCostOfPlan(t.allProducts,1,n.selectedToggle.planPaymentInterval)))),k.Bb(4),k.Qc(k.mc(38,37,"subscription.plans.perUserMonthly")),k.Bb(2),k.rc("ngIf",n.selectedToggle.planPaymentInterval===n.PlanPaymentInterval.MONTHLY),k.Bb(2),k.rc("ngForOf",k.vc(59,he)),k.Bb(2),k.rc("productState",t),k.Bb(4),k.Qc(k.mc(48,39,"subscription.storage.perUser")),k.Bb(4),k.Qc(k.mc(52,41,"subscription.plans.premium.note")),k.Bb(4),k.Qc(k.mc(56,43,"subscription.plans.premium.title")),k.Bb(4),k.Qc(k.nc(60,45,"subscription.plans.costs",k.wc(60,ue,n.getCostOfPlan(t.allProducts,2,n.selectedToggle.planPaymentInterval)))),k.Bb(4),k.Qc(k.mc(64,48,"subscription.plans.perUserMonthly")),k.Bb(2),k.rc("ngIf",n.selectedToggle.planPaymentInterval===n.PlanPaymentInterval.MONTHLY),k.Bb(3),k.rc("ngForOf",k.vc(62,fe)),k.Bb(1),k.rc("ngForOf",k.vc(63,be)),k.Bb(2),k.Rc(" ",k.mc(72,50,"subscription.plans.premium.includingProFeatures")," "),k.Bb(5),k.Qc(k.mc(77,52,"subscription.plans.premium.comingSoon")),k.Bb(4),k.rc("productChange",k.mc(81,54,n.productChange$))}}const ve=[{path:"",component:kt,pathMatch:"full",data:{authGuardPipe:Nt.b}},{path:"products",component:(()=>{class t{constructor(t,e,n,i,c,r,d,l,p,g,b,u,h){this.authService=t,this.companyService=e,this.profileService=n,this.productService=i,this.subscriptionService=c,this.subscriptionWizardDialog=r,this.productChangeService=d,this.trackingDispatchService=l,this.router=p,this.decimalPipe=g,this.hotjarTrackingService=b,this.activeRoute=u,this.store=h,this.items=[{translateKey:"subscription.billingPeriod.yearly.title",note:"subscription.billingPeriod.yearly.note",planPaymentInterval:a.PlanPaymentInterval.YEARLY},{translateKey:"subscription.billingPeriod.monthly.title",planPaymentInterval:a.PlanPaymentInterval.MONTHLY}],this.PlanPaymentInterval=a.PlanPaymentInterval,this.destroy$=new s.a,this.subscription$=new o.a(null),this.products$=this.store.select(S),this.itemSelected(0,!1),this.initSubscriptionOfCompany(),this.initProductState(),this.initCompany(),this.initProductChanges(),this.initConfirmationWatch(),this.initWizard(),this.initToggleWatch(),this.initDirectlyRoutedProduct()}get selectedToggleIndex(){return this.selectedToggle?this.items.findIndex(t=>t.planPaymentInterval===this.selectedToggle.planPaymentInterval):0}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}itemSelected(t,e){this.selectedToggle=this.items[t],this.productChangeService.updatePaymentInterval(this.selectedToggle.planPaymentInterval),e&&this.trackingDispatchService.emitTrackingEvent(x.a.SUBSCRIPTION_PRODUCTS_INTERVAL_TOGGLE,{type:this.selectedToggle.planPaymentInterval})}initCompany(){this.company$=this.authService.$authState.pipe(Object(p.a)(t=>this.profileService.getProfile(t.uid)),Object(p.a)(t=>this.companyService.getCompany(t.company)),Object(g.a)())}initProductState(){this.productState$=Object(d.b)([this.subscription$,this.products$]).pipe(Object(h.a)(t=>{const[e,n]=t;if(!e){const t=Object(P.j)(n);return{currentProduct:t,nextProduct:t,allProducts:n}}return{currentProduct:Object(P.q)(n,e),nextProduct:Object(P.r)(n,e),allProducts:n}}))}initProductChanges(){this.productChange$=this.productChangeService.getProductChanges().pipe(Object(l.a)(t=>t.changeType===m.a.NEW_SUBSCRIPTION||t.changeType===m.a.PRODUCT_CHANGE),Object(h.a)(t=>t))}initSubscriptionOfCompany(){const t=this.subscriptionService.getCompanySubscriptions().pipe();Object(d.b)([this.products$,t]).pipe(Object(h.a)(t=>{const[e,n]=t;return n.find(t=>Object(P.q)(e,t).type===a.ProductType.SUBSCRIPTION)}),Object(b.a)(this.destroy$)).subscribe(t=>{this.subscription$.next(t)})}initToggleWatch(){Object(d.b)([this.subscription$,this.products$]).pipe(Object(h.a)(([t,e])=>{if(!t)return;const n=Object(P.h)(e,t);this.selectedToggle=this.items.find(t=>t.planPaymentInterval===n.paymentInterval)}),Object(b.a)(this.destroy$)).subscribe()}openSubscriptionWizard(t){return Object(r.a)(this,void 0,void 0,(function*(){const e={products:yield this.products$.pipe(Object(jt.a)(1)).toPromise(),productChange:t};e&&(this.wizardDialogRef=this.subscriptionWizardDialog.open(Rt.a,{data:e,disableClose:!0,panelClass:"no-padding-dialog"}))}))}initConfirmationWatch(){this.productChange$.pipe(Object(l.a)(t=>t.changeType===m.a.PRODUCT_CHANGE||t.changeType===m.a.NEW_SUBSCRIPTION),Object(l.a)(t=>t.status===v.a.CONFIRMED),Object(b.a)(this.destroy$)).subscribe(()=>{this.wizardDialogRef&&this.wizardDialogRef.close(),this.router.navigate(["settings/subscription"])})}initWizard(){this.productChange$.pipe(Object(l.a)(t=>t.changeType===m.a.NEW_SUBSCRIPTION&&t.status===v.a.OPEN),Object(b.a)(this.destroy$)).subscribe(t=>{this.trackWizardOpen(t),this.openSubscriptionWizard(t)})}getCostOfPlan(t,e,n){const i=Object(P.n)(t,e),c=Object(P.m)(i,n);return this.decimalPipe.transform(c.costPerUser[Dt.a]/(n===a.PlanPaymentInterval.MONTHLY?1:12),"1.2-2")}trackWizardOpen(t){1===t.to.product.grade?this.trackingDispatchService.emitTrackingEvent(x.a.SUBSCRIPTION_PRODUCTS_WIZARD_OPEN,{type:"pro"}):2===t.to.product.grade&&this.trackingDispatchService.emitTrackingEvent(x.a.SUBSCRIPTION_PRODUCTS_WIZARD_OPEN,{type:"premium"})}initDirectlyRoutedProduct(){return Object(r.a)(this,void 0,void 0,(function*(){const t=this.activeRoute.snapshot.queryParams.product,e=this.activeRoute.snapshot.queryParams.term;if(!e&&!t)return;const[n,i,c]=yield Object(d.b)([this.subscriptionService.getCurrentSubscription(),this.store.select(M),this.store.select(O.p).pipe(Object(h.a)(t=>!(!t||!t.trialSubscription)))]).pipe(Object(jt.a)(1)).toPromise();if(!n||c){if(e&&(this.selectedToggle=this.items.find(t=>t.planPaymentInterval===e.toUpperCase())||this.items[0],this.productChangeService.updatePaymentInterval(this.selectedToggle.planPaymentInterval)),t){const e=t.toLowerCase(),n=i.find(t=>t.shortName.toLowerCase()===e);if(!n)return;this.productChangeService.scheduleProductChange(n.grade)}}else this.router.navigate(["settings/subscription"])}))}}return t.\u0275fac=function(e){return new(e||t)(k.Ob(H.a),k.Ob(q.a),k.Ob(Y.a),k.Ob(Z.a),k.Ob(W.b),k.Ob(B.b),k.Ob(K.a),k.Ob(at.a),k.Ob(c.g),k.Ob(i.f),k.Ob(J.a),k.Ob(c.a),k.Ob(C.h))},t.\u0275cmp=k.Ib({type:t,selectors:[["app-products"]],features:[k.Ab([i.f])],decls:19,vars:7,consts:[[1,"d-flex","flex-column","justify-content-between","products-wrapper"],[1,"toggle-container"],["class","row justify-content-center py-4",4,"ngIf"],["class","cf-cards-container",4,"ngIf"],[1,"trust-badge-wrapper"],[1,"d-flex","align-items-end","justify-content-center","h-100"],[1,"container","mb-3"],[1,"row"],[1,"col-xl-3","col-5"],["name","refund",3,"iconHeight"],["name","award"],["name","support"],["name","madeInGermany"],[1,"row","justify-content-center","py-4"],[1,"col-auto"],[3,"items","selectedToggleIndex","selected"],[1,"cf-cards-container"],[1,"container"],[1,"row","justify-content-center"],[1,"col-4"],["gradeOfCard","0",3,"productState"],[1,"corner-content","font-weight-bold"],[1,"corner-content"],[1,"row","justify-content-center","mt-5"],[1,"col-auto","cf-h1"],[1,"col-auto","cf-text"],[1,"row","justify-content-center","my-5"],["class","col-12 text-center cf-text cf-text-1",4,"ngFor","ngForOf"],["gradeOfCard","1",3,"productState"],[1,"row","justify-content-center","my-2"],[1,"col-12","text-center","cf-text","cf-text-2"],["class","col-12 text-center cf-text cf-text-2",4,"ngIf"],["class","col-12 text-center cf-text",3,"ngClass",4,"ngFor","ngForOf"],["gradeOfCard","2",3,"productState"],[1,"row","justify-content-center","mt-3"],[1,"col-auto","cf-suggested-text"],[1,"row","justify-content-center","mt-2"],["class","col-12 text-center cf-text cf-text-1 cf-text-upcoming",4,"ngFor","ngForOf"],[1,"col-12","text-center","cf-text","cf-text-italic","mt-2"],[1,"col"],[1,"text-right","mt-2","montserrat-text-light","mr-3","coming-soon"],[1,"row","justify-content-center","pt-4"],[1,"col-7"],[3,"productChange"],[1,"col-12","text-center","cf-text","cf-text-1"],[1,"col-12","text-center","cf-text",3,"ngClass"],[1,"col-12","text-center","cf-text","cf-text-1","cf-text-upcoming"],[1,"asterisk"]],template:function(t,e){1&t&&(k.Ub(0,"div",0),k.Ub(1,"div"),k.Ub(2,"div",1),k.Nc(3,re,3,2,"div",2),k.lc(4,"async"),k.Tb(),k.Nc(5,me,82,64,"div",3),k.lc(6,"async"),k.Tb(),k.Ub(7,"div",4),k.Ub(8,"div",5),k.Ub(9,"div",6),k.Ub(10,"div",7),k.Ub(11,"div",8),k.Pb(12,"app-trust-badge",9),k.Tb(),k.Ub(13,"div",8),k.Pb(14,"app-trust-badge",10),k.Tb(),k.Ub(15,"div",8),k.Pb(16,"app-trust-badge",11),k.Tb(),k.Ub(17,"div",8),k.Pb(18,"app-trust-badge",12),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb(),k.Tb()),2&t&&(k.Bb(3),k.rc("ngIf",!k.mc(4,3,e.subscription$)),k.Bb(2),k.rc("ngIf",k.mc(6,5,e.productState$)),k.Bb(7),k.rc("iconHeight",124))},directives:[i.p,Et.a,Gt,Xt,i.o,ce,i.n],pipes:[i.b,$.d],styles:[".cf-suggested-text[_ngcontent-%COMP%]{color:#ff5c20;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px;text-align:center}.cf-change-confirmation[_ngcontent-%COMP%]{min-height:100px;border-radius:16px;border:1px solid #000}.cf-cards-container[_ngcontent-%COMP%]{position:relative;width:100%;top:5vh;display:flex;align-items:center;flex-direction:column}.coming-soon[_ngcontent-%COMP%]{size:13px;color:#927f7a}.asterisk[_ngcontent-%COMP%]{display:inline;size:13px}.products-wrapper[_ngcontent-%COMP%]{height:90vh}@media (min-width:1600px){.container[_ngcontent-%COMP%]{max-width:1400px}}@media (min-height:600px) and (max-height:1190px) and (min-width:1201px){.trust-badge-wrapper[_ngcontent-%COMP%]{height:340px}.products-wrapper[_ngcontent-%COMP%]{height:calc(100vh + 50px)}}.toggle-container[_ngcontent-%COMP%]{min-height:7vh}@media (min-height:1150px){.toggle-container[_ngcontent-%COMP%]{min-height:10vh}}",".footerfix[_ngcontent-%COMP%]{padding:0 0 6em;overflow:auto}.settings-other[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{height:24px;width:24px}.delete[_ngcontent-%COMP%]{background:#d12c3f}h2[_ngcontent-%COMP%]{font-size:24px;font-family:Archive,sans-serif}.theme-item[_ngcontent-%COMP%]{font-size:.9em;padding:4px 28px}footer[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;left:0;padding:1rem}.cf-text[_ngcontent-%COMP%]{opacity:.6;color:var(--overview-font);font-family:Montserrat,sans-serif;font-weight:500;font-size:24px;line-height:32px}.cf-text-upcoming[_ngcontent-%COMP%]{opacity:.4}.cf-text-1[_ngcontent-%COMP%]{font-size:16px;line-height:24px}.cf-text-2[_ngcontent-%COMP%]{font-size:12px;line-height:20px}.cf-text-italic[_ngcontent-%COMP%]{font-size:16px;font-style:italic;font-weight:500;line-height:24px}.cf-h1[_ngcontent-%COMP%]{color:var(--overview-font);font-family:Montserrat,sans-serif;font-size:24px;font-weight:700;line-height:32px}.cf-h2[_ngcontent-%COMP%]{color:var(--overview-font)}.cf-button[_ngcontent-%COMP%], .cf-h2[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px}.cf-button[_ngcontent-%COMP%]{color:#ff5c20;padding:6px 12px}button[mat-flat-button][_ngcontent-%COMP%]{padding:12px 24px;border-radius:24px;font-family:Montserrat,sans-serif;font-size:16px;font-weight:700;line-height:24px}.cf-form-field[_ngcontent-%COMP%]{padding:0 32px;border-radius:16px;background-color:var(--overview-line-background)}.cf-form-field.sm-pad[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px}.cf-form-field.lg-pad[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px}.cf-icon-placeholder[_ngcontent-%COMP%]{width:24px}mat-progress-bar[_ngcontent-%COMP%]{margin-top:16px}.mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}.spinner-container[_ngcontent-%COMP%]{padding:7px 35px}"]}),t})(),pathMatch:"full",data:{authGuardPipe:Nt.b}}];let Pe=(()=>{class t{}return t.\u0275mod=k.Mb({type:t}),t.\u0275inj=k.Lb({factory:function(e){return new(e||t)},imports:[[c.l.forChild(ve)],c.l]}),t})();var xe=n("PCNd"),Oe=n("9jGm");let Ce=(()=>{class t{constructor(t,e){this.actions$=t,this.productService=e,this.loadProducts$=this.actions$.pipe(Object(Oe.d)(T),Object(u.a)(()=>this.productService.getAvailableProducts()),Object(h.a)(t=>y({products:t})))}ngrxOnInitEffects(){return T()}}return t.\u0275fac=function(e){return new(e||t)(k.cc(Oe.a),k.cc(Z.a))},t.\u0275prov=k.Kb({token:t,factory:t.\u0275fac}),Object(r.b)([Object(Oe.b)(),Object(r.c)("design:type",Object)],t.prototype,"loadProducts$",void 0),t})(),Te=(()=>{class t{}return t.\u0275mod=k.Mb({type:t}),t.\u0275inj=k.Lb({factory:function(e){return new(e||t)},providers:[J.a],imports:[[i.c,xe.a,Pe,C.j.forFeature("products",_),Oe.c.forFeature([Ce]),G],Pe]}),t})()}}]);